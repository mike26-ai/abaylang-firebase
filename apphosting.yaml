# Settings to manage and configure a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

# The version of the App Hosting runtime.
# We recommend using the latest major version.
runtime: nodejs20 # Or nodejs20, depending on your Next.js version and preferences

# buildSteps allows you to install dependencies and build your static assets.
# These commands are executed on the server during every new deployment.
# Npm is used by default, but you can specify pnpm or yarn via packageManager.
buildSteps:
  - run: npm install 
  - run: npm run build 

# Settings for the server that serves your app.
# https://firebase.google.com/docs/app-hosting/configure#server-settings
runConfig:
  # App Hosting uses Cloud Run instances to run your application.
  # You can specify the CPU and memory of these instances.
  # Default: 0.5 CPU, 512MiB memory
  # cpu: 1
  # memoryMiB: 1024
  # The maximum number of instances that can be started to handle requests.
  # Default: 100
  maxInstances: 2 # Keep low for MVP / cost control, adjust based on traffic
  # The minimum number of instances that will be kept warm to reduce cold starts.
  # Default: 0
  # minInstances: 0
  # The number of concurrent requests an instance can receive.
  # Default: 80
  # concurrency: 80

# Defines environment variables that will be available at build time and runtime.
# https://firebase.google.com/docs/app-hosting/configure#environment-variables
env:
  - variable: NEXT_PUBLIC_ADMIN_EMAIL
    value: "mahdernmamo@gmail.com" # Admin email for the site
  - variable: NEXT_PUBLIC_RECAPTCHA_SITE_KEY
    value: "YOUR_RECAPTCHA_SITE_KEY_HERE" # TODO: Replace with your actual Site Key from Google reCAPTCHA admin.
  - variable: NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME
    value: "YOUR_CLOUD_NAME_HERE" # TODO: Replace with your Cloudinary Cloud Name
  - variable: NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET
    value: "YOUR_UPLOAD_PRESET_HERE" # TODO: Replace with your Cloudinary Upload Preset
  
  # --- SERVER-SIDE SECRETS ---
  # These are required for server actions to function correctly.
  # TODO: Replace these placeholder values with your actual secrets.
  # For production, it is highly recommended to use Secret Manager.
  - variable: PADDLE_API_KEY
    value: "YOUR_PADDLE_API_KEY_HERE"
  - variable: PADDLE_WEBHOOK_SECRET
    value: "YOUR_PADDLE_WEBHOOK_SECRET_HERE"
  - variable: CLOUDINARY_API_KEY
    value: "YOUR_CLOUDINARY_API_KEY_HERE"
  - variable: CLOUDINARY_API_SECRET
    value: "YOUR_CLOUDINARY_API_SECRET_HERE"

# It's generally recommended to use Secret Manager for sensitive env vars.
# Example using secrets:
#  - variable: PADDLE_API_KEY
#    secret: PADDLE_API_KEY_SECRET_NAME
#  - variable: PADDLE_WEBHOOK_SECRET
#    secret: PADDLE_WEBHOOK_SECRET_NAME
    

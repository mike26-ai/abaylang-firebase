(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{8838:function(e,s,t){Promise.resolve().then(t.bind(t,9315))},9315:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return A}});var l=t(57437),i=t(2265),a=t(89733),n=t(48185),r=t(79055),d=t(86864),c=t(47304),o=t(85915),x=t(1035),m=t(90809),h=t(87080),u=t(74430),j=t(62037),f=t(74732),g=t(87138),p=t(16463),b=t(87786),N=t(4716),v=t(80624),w=t(28420),y=t(91892),C=t(86763),k=t(69842),S=t(89506);function A(){let{user:e,loading:s,signOut:t,isAdmin:A}=(0,b.a)(),R=(0,p.useRouter)(),{toast:T}=(0,C.pm)(),[Z,B]=(0,i.useState)(null),[E,P]=(0,i.useState)(!0),[z,D]=(0,i.useState)({id:null,action:null});(0,i.useEffect)(()=>{if(!s){if(!e){R.push("/login");return}if(!A){R.push("/profile");return}(async()=>{P(!0);try{var e;let s=await (null===(e=S.I.currentUser)||void 0===e?void 0:e.getIdToken());if(!s)throw Error("Not authenticated");let t=await fetch("/api/admin/dashboard-stats",{headers:{Authorization:"Bearer ".concat(s)}});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to fetch dashboard data")}let l=await t.json();B(l)}catch(e){console.error("Error fetching dashboard data:",e),T({title:"Error",description:e.message||"Could not load dashboard data.",variant:"destructive"})}finally{P(!1)}})()}},[e,A,s,R,T]);let O=async(e,s)=>{if(Z){D({id:e,action:s});try{let t=(0,k.JU)(S.db,"testimonials",e);await (0,k.r7)(t,{status:s}),B(s=>s?{...s,pendingTestimonials:s.pendingTestimonials.filter(s=>s.id!==e),stats:{...s.stats,pendingTestimonialsCount:Math.max(0,s.stats.pendingTestimonialsCount-1)}}:null),T({title:"Success",description:"Testimonial ".concat(s,".")})}catch(e){console.error("Error updating testimonial:",e),T({title:"Error",description:"Could not update testimonial status.",variant:"destructive"})}finally{D({id:null,action:null})}}};if(s||E||!e||!A)return(0,l.jsxs)("div",{className:"min-h-screen flex items-center justify-center",children:[(0,l.jsx)(y.$,{size:"lg"})," ",(0,l.jsx)("p",{className:"ml-3 text-muted-foreground",children:"Loading Dashboard..."})]});if(!Z)return(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsx)("p",{className:"text-muted-foreground",children:"Could not load dashboard data. Please try again."})});let{stats:M,recentBookings:U,pendingTestimonials:Y,recentMessages:q,recentStudents:_}=Z;return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-primary/5 to-background",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsx)("header",{className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-foreground mb-1",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-lg text-muted-foreground",children:"Overview of ABYLANG activities."})]})}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsxs)(n.Zb,{className:"shadow-lg hover-lift",children:[(0,l.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(n.ll,{className:"text-sm font-medium",children:"Upcoming Bookings"}),(0,l.jsx)(o.Z,{className:"h-5 w-5 text-primary"})]}),(0,l.jsxs)(n.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:M.upcomingBookings}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"confirmed lessons"})]})]}),(0,l.jsxs)(n.Zb,{className:"shadow-lg hover-lift",children:[(0,l.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(n.ll,{className:"text-sm font-medium",children:"Active Students"}),(0,l.jsx)(x.Z,{className:"h-5 w-5 text-primary"})]}),(0,l.jsxs)(n.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:M.totalStudents}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"registered"})]})]}),(0,l.jsxs)(n.Zb,{className:"shadow-lg hover-lift",children:[(0,l.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(n.ll,{className:"text-sm font-medium",children:"Monthly Revenue (Est.)"}),(0,l.jsx)(m.Z,{className:"h-5 w-5 text-primary"})]}),(0,l.jsxs)(n.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:["$",M.totalRevenue.toFixed(0)]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"placeholder data"})]})]}),(0,l.jsxs)(n.Zb,{className:"shadow-lg hover-lift",children:[(0,l.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(n.ll,{className:"text-sm font-medium",children:"Average Rating"}),(0,l.jsx)(h.Z,{className:"h-5 w-5 text-primary"})]}),(0,l.jsxs)(n.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:M.averageRating.toFixed(1)}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"from approved testimonials"})]})]})]}),(M.pendingTestimonialsCount>0||M.newInquiries>0||M.newBookingsCount>0)&&(0,l.jsx)(n.Zb,{className:"shadow-lg mb-8 bg-gradient-to-r from-primary/5 to-accent/30",children:(0,l.jsxs)(n.aY,{className:"p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-3",children:"Action Required"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[M.newBookingsCount>0&&(0,l.jsxs)(r.C,{variant:"secondary",className:"bg-blue-400/20 text-blue-700 dark:text-blue-500 border-blue-400/30",children:[(0,l.jsx)(u.Z,{className:"mr-1.5 h-3 w-3"}),M.newBookingsCount," new booking",M.newBookingsCount>1?"s":""," awaiting confirmation"]}),M.pendingTestimonialsCount>0&&(0,l.jsxs)(r.C,{variant:"secondary",className:"bg-yellow-400/20 text-yellow-700 dark:text-yellow-500 border-yellow-400/30",children:[M.pendingTestimonialsCount," testimonial",M.pendingTestimonialsCount>1?"s":""," pending"]}),M.newInquiries>0&&(0,l.jsxs)(r.C,{variant:"secondary",className:"bg-blue-400/20 text-blue-700 dark:text-blue-500 border-blue-400/30",children:[M.newInquiries," new message",M.newInquiries>1?"s":""]})]})]})}),(0,l.jsxs)(d.mQ,{defaultValue:"bookings",className:"space-y-6",children:[(0,l.jsxs)(d.dr,{className:"bg-card border w-full sm:w-auto grid grid-cols-2 sm:grid-cols-4",children:[(0,l.jsxs)(d.SP,{value:"bookings",className:"relative",children:["Bookings",M.newBookingsCount>0&&(0,l.jsx)(r.C,{className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center bg-blue-500 text-white text-xs rounded-full",children:M.newBookingsCount})]}),(0,l.jsxs)(d.SP,{value:"testimonials",className:"relative",children:["Testimonials",M.pendingTestimonialsCount>0&&(0,l.jsx)(r.C,{className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center bg-destructive text-destructive-foreground text-xs rounded-full",children:M.pendingTestimonialsCount})]}),(0,l.jsxs)(d.SP,{value:"messages",className:"relative",children:["Messages",M.newInquiries>0&&(0,l.jsx)(r.C,{className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center bg-blue-500 text-white text-xs rounded-full",children:M.newInquiries})]}),(0,l.jsx)(d.SP,{value:"students",children:"Students"})]}),(0,l.jsx)(d.nU,{value:"bookings",children:(0,l.jsxs)(n.Zb,{className:"shadow-xl",children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsx)(n.ll,{children:"Recent Lesson Bookings"}),(0,l.jsx)(n.SZ,{children:"Overview of the latest scheduled lessons."})]}),(0,l.jsxs)(n.aY,{children:[0===U.length?(0,l.jsx)("p",{className:"text-muted-foreground",children:"No recent bookings."}):(0,l.jsxs)(c.iA,{children:[(0,l.jsx)(c.xD,{children:(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.ss,{children:"Student"}),(0,l.jsx)(c.ss,{children:"Date & Time"}),(0,l.jsx)(c.ss,{children:"Lesson Type"}),(0,l.jsx)(c.ss,{children:"Status"})]})}),(0,l.jsx)(c.RM,{children:U.map(e=>(0,l.jsxs)(c.SC,{children:[(0,l.jsxs)(c.pj,{children:[(0,l.jsx)("div",{className:"font-medium",children:e.userName}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:e.userEmail})]}),(0,l.jsx)(c.pj,{children:e.date&&"N/A_PACKAGE"!==e.date&&(0,N.J)((0,v.D)(e.date))?"".concat((0,w.WU)((0,v.D)(e.date),"PP")," at ").concat(e.time):"Package"}),(0,l.jsx)(c.pj,{children:e.lessonType||"".concat(e.duration," min")}),(0,l.jsx)(c.pj,{children:(0,l.jsx)(r.C,{variant:"confirmed"===e.status?"default":"completed"===e.status?"secondary":"cancelled"===e.status?"destructive":"secondary",className:"awaiting-payment"===e.status?"bg-yellow-400/20 text-yellow-700 dark:text-yellow-500 border-yellow-400/30":"payment-pending-confirmation"===e.status?"bg-blue-400/20 text-blue-700 dark:text-blue-500 border-blue-400/30":"",children:e.status.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())})})]},e.id))})]}),(0,l.jsx)("div",{className:"mt-4 text-right",children:(0,l.jsx)(a.z,{variant:"outline",asChild:!0,children:(0,l.jsx)(g.default,{href:"/admin/bookings",children:"View All Bookings"})})})]})]})}),(0,l.jsx)(d.nU,{value:"testimonials",children:(0,l.jsxs)(n.Zb,{className:"shadow-xl",children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsx)(n.ll,{children:"Pending Testimonials"}),(0,l.jsx)(n.SZ,{children:"Review and approve or reject new student feedback."})]}),(0,l.jsxs)(n.aY,{children:[0===Y.length?(0,l.jsx)("p",{className:"text-muted-foreground",children:"No pending testimonials."}):(0,l.jsxs)(c.iA,{children:[(0,l.jsx)(c.xD,{children:(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.ss,{children:"Student"}),(0,l.jsx)(c.ss,{children:"Rating"}),(0,l.jsx)(c.ss,{children:"Comment"}),(0,l.jsx)(c.ss,{children:"Actions"})]})}),(0,l.jsx)(c.RM,{children:Y.map(e=>(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.pj,{className:"font-medium",children:e.name}),(0,l.jsx)(c.pj,{children:(0,l.jsx)("div",{className:"flex items-center gap-0.5",children:[void 0,void 0,void 0,void 0,void 0].map((s,t)=>(0,l.jsx)(h.Z,{className:"w-3.5 h-3.5 ".concat(t<e.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground/30")},t))})}),(0,l.jsx)(c.pj,{className:"max-w-xs truncate",children:e.comment}),(0,l.jsx)(c.pj,{children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(a.z,{variant:"outline",size:"sm",className:"text-primary border-primary/30 hover:bg-primary/10 hover:text-primary",onClick:()=>O(e.id,"approved"),disabled:z.id===e.id,children:[z.id===e.id&&"approved"===z.action?(0,l.jsx)(y.$,{size:"sm",className:"mr-1"}):(0,l.jsx)(j.Z,{className:"w-4 h-4 mr-1"})," Approve"]}),(0,l.jsxs)(a.z,{variant:"outline",size:"sm",className:"text-destructive border-destructive/30 hover:bg-destructive/10 hover:text-destructive",onClick:()=>O(e.id,"rejected"),disabled:z.id===e.id,children:[z.id===e.id&&"rejected"===z.action?(0,l.jsx)(y.$,{size:"sm",className:"mr-1"}):(0,l.jsx)(f.Z,{className:"w-4 h-4 mr-1"})," Reject"]})]})})]},e.id))})]}),(0,l.jsx)("div",{className:"mt-4 text-right",children:(0,l.jsx)(a.z,{variant:"outline",asChild:!0,children:(0,l.jsx)(g.default,{href:"/admin/testimonials",children:"View All Testimonials"})})})]})]})}),(0,l.jsx)(d.nU,{value:"messages",children:(0,l.jsxs)(n.Zb,{className:"shadow-xl",children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsx)(n.ll,{children:"Recent Contact Messages"}),(0,l.jsx)(n.SZ,{children:"Latest inquiries from students and visitors."})]}),(0,l.jsxs)(n.aY,{children:[0===q.length?(0,l.jsx)("p",{className:"text-muted-foreground",children:"No recent messages."}):(0,l.jsxs)(c.iA,{children:[(0,l.jsx)(c.xD,{children:(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.ss,{children:"Name"}),(0,l.jsx)(c.ss,{children:"Email"}),(0,l.jsx)(c.ss,{children:"Message (Preview)"}),(0,l.jsx)(c.ss,{children:"Status"})]})}),(0,l.jsx)(c.RM,{children:q.map(e=>(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.pj,{className:"font-medium",children:e.name}),(0,l.jsx)(c.pj,{children:e.email}),(0,l.jsx)(c.pj,{className:"max-w-xs truncate",children:e.message}),(0,l.jsx)(c.pj,{children:(0,l.jsx)(r.C,{variant:e.read?"secondary":"default",children:e.read?"Read":"Unread"})})]},e.id))})]}),(0,l.jsx)("div",{className:"mt-4 text-right",children:(0,l.jsx)(a.z,{variant:"outline",asChild:!0,children:(0,l.jsx)(g.default,{href:"/admin/inquiries",children:"View All Messages"})})})]})]})}),(0,l.jsx)(d.nU,{value:"students",children:(0,l.jsxs)(n.Zb,{className:"shadow-xl",children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsx)(n.ll,{children:"Recently Joined Students"}),(0,l.jsx)(n.SZ,{children:"New members of the ABYLANG community."})]}),(0,l.jsxs)(n.aY,{children:[0===_.length?(0,l.jsx)("p",{className:"text-muted-foreground",children:"No recent students."}):(0,l.jsxs)(c.iA,{children:[(0,l.jsx)(c.xD,{children:(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.ss,{children:"Name"}),(0,l.jsx)(c.ss,{children:"Email"}),(0,l.jsx)(c.ss,{children:"Joined"}),(0,l.jsx)(c.ss,{children:"Level"})]})}),(0,l.jsx)(c.RM,{children:_.map(e=>{var s;return(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.pj,{className:"font-medium",children:e.name}),(0,l.jsx)(c.pj,{children:e.email}),(0,l.jsx)(c.pj,{children:e.createdAt&&(0,N.J)((0,v.D)(e.createdAt))?(0,w.WU)((0,v.D)(e.createdAt),"PP"):"N/A"}),(0,l.jsx)(c.pj,{children:(0,l.jsx)(r.C,{variant:"outline",children:(null===(s=e.amharicLevel)||void 0===s?void 0:s.replace(/-/g," "))||"N/A"})})]},e.uid)})})]}),(0,l.jsx)("div",{className:"mt-4 text-right",children:(0,l.jsx)(a.z,{variant:"outline",asChild:!0,children:(0,l.jsx)(g.default,{href:"/admin/students",children:"View All Students"})})})]})]})})]})]})})}},47304:function(e,s,t){"use strict";t.d(s,{RM:function(){return d},SC:function(){return c},iA:function(){return n},pj:function(){return x},ss:function(){return o},xD:function(){return r}});var l=t(57437),i=t(2265),a=t(49354);let n=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:s,className:(0,a.cn)("w-full caption-bottom text-sm",t),...i})})});n.displayName="Table";let r=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("thead",{ref:s,className:(0,a.cn)("[&_tr]:border-b",t),...i})});r.displayName="TableHeader";let d=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("tbody",{ref:s,className:(0,a.cn)("[&_tr:last-child]:border-0",t),...i})});d.displayName="TableBody",i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("tfoot",{ref:s,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...i})}).displayName="TableFooter";let c=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("tr",{ref:s,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...i})});c.displayName="TableRow";let o=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("th",{ref:s,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...i})});o.displayName="TableHead";let x=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("td",{ref:s,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...i})});x.displayName="TableCell",i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,l.jsx)("caption",{ref:s,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",t),...i})}).displayName="TableCaption"}},function(e){e.O(0,[4358,139,6244,537,231,3959,381,6562,2911,4146,2971,7023,1744],function(){return e(e.s=8838)}),_N_E=e.O()}]);
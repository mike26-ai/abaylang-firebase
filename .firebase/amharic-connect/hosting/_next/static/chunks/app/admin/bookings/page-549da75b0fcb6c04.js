(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9424],{83611:function(e,t,s){Promise.resolve().then(s.bind(s,59625))},59625:function(e,t,s){"use strict";s.d(t,{BookingsManager:function(){return _}});var a=s(57437),n=s(2265),i=s(69842),l=s(89506),r=s(47304),o=s(79055),d=s(89733),c=s(31590),m=s(12859),u=s(14468),f=s(74430),x=s(3424),p=s(62037),h=s(44182),g=s(19847),j=s(85915),N=s(49489),b=s(20530),k=s(4716),y=s(28420),v=s(80624),w=s(86763),C=s(91892),z=s(29943),P=s(54662),A=s(89736),Z=s(70402),E=s(77209),S=s(48185);let D=(e,t)=>{if(!e)return"N/A";if(e.toDate&&"function"==typeof e.toDate){let s=e.toDate();return(0,k.J)(s)?(0,y.WU)(s,t):"Invalid Date"}if("string"==typeof e){let s=(0,v.D)(e);if((0,k.J)(s))return(0,y.WU)(s,t);let[a,n,i]=e.split("-").map(Number);if(a&&n&&i){let e=new Date(a,n-1,i);if((0,k.J)(e))return(0,y.WU)(e,t)}}return e instanceof Date&&(0,k.J)(e)?(0,y.WU)(e,t):"Invalid Date"};function _(){var e,t;let[s,k]=(0,n.useState)([]),[y,v]=(0,n.useState)(!0),{toast:_}=(0,w.pm)(),[O,L]=(0,n.useState)({isOpen:!1,booking:null,link:"",isSaving:!1}),[R,V]=(0,n.useState)(null),J=async()=>{v(!0);try{let e=(0,i.hJ)(l.db,"bookings"),t=(0,i.IO)(e,(0,i.Xo)("createdAt","desc")),s=(await (0,i.PL)(t)).docs.map(e=>({id:e.id,...e.data()}));k(s)}catch(e){console.error("Error fetching bookings:",e),_({title:"Error",description:"Could not fetch bookings.",variant:"destructive"})}finally{v(!1)}};(0,n.useEffect)(()=>{J()},[]);let U=async e=>{try{let t=(0,i.JU)(l.db,"users",e),s=await (0,i.QT)(t);if(s.exists()){let a=s.data();if(!a.hasSubmittedFirstLessonFeedback){let s=(0,i.IO)((0,i.hJ)(l.db,"bookings"),(0,i.ar)("userId","==",e),(0,i.ar)("status","==","completed")),n=await (0,i.PL)(s);0===n.size&&(await (0,i.r7)(t,{showFirstLessonFeedbackPrompt:!0}),_({title:"Feedback Prompt Sent",description:"Prompt enabled for ".concat(a.name,".")}))}}}catch(e){console.error("Error triggering first lesson feedback prompt:",e)}},F=async(e,t)=>{try{"completed"===t&&"completed"!==e.status&&await U(e.userId);let s=(0,i.JU)(l.db,"bookings",e.id);await (0,i.r7)(s,{status:t}),_({title:"Success",description:"Booking status updated to ".concat(t,".")}),J()}catch(e){console.error("Error updating booking status:",e),_({title:"Error",description:"Could not update booking status.",variant:"destructive"})}},T=async e=>{try{let t=(0,i.JU)(l.db,"bookings",e);await (0,i.oe)(t),_({title:"Success",description:"Booking deleted."}),V(null),J()}catch(e){console.error("Error deleting booking:",e),_({title:"Error",description:"Could not delete booking.",variant:"destructive"})}},Y=async()=>{if(O.booking&&O.link){L(e=>({...e,isSaving:!0}));try{let e=(0,i.JU)(l.db,"bookings",O.booking.id);await (0,i.r7)(e,{zoomLink:O.link}),_({title:"Zoom Link Saved",description:"The student will see the join button once the lesson is confirmed."}),L({isOpen:!1,booking:null,link:"",isSaving:!1}),J()}catch(e){console.error("Error saving Zoom link:",e),_({title:"Error",description:"Could not save the Zoom link.",variant:"destructive"}),L(e=>({...e,isSaving:!1}))}}},I=e=>"awaiting-payment"===e?"Awaiting Tutor Confirmation":"payment-pending-confirmation"===e?"Pending Confirmation":e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase());return y?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(C.$,{size:"lg"})}):0===s.length?(0,a.jsx)("p",{className:"text-muted-foreground",children:"No bookings found."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,a.jsxs)(r.iA,{children:[(0,a.jsx)(r.xD,{children:(0,a.jsxs)(r.SC,{children:[(0,a.jsx)(r.ss,{children:"Student Name"}),(0,a.jsx)(r.ss,{children:"Email"}),(0,a.jsx)(r.ss,{children:"Date"}),(0,a.jsx)(r.ss,{children:"Time"}),(0,a.jsx)(r.ss,{children:"Status"}),(0,a.jsx)(r.ss,{children:"Booked On"}),(0,a.jsx)(r.ss,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(r.RM,{children:s.map(e=>(0,a.jsxs)(r.SC,{children:[(0,a.jsx)(r.pj,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.userName,e.paymentNote&&(0,a.jsx)(A.pn,{children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(A.aJ,{asChild:!0,children:(0,a.jsx)(m.Z,{className:"h-4 w-4 text-primary cursor-pointer"})}),(0,a.jsx)(A._v,{children:(0,a.jsx)("p",{className:"max-w-xs",children:e.paymentNote})})]})})]})}),(0,a.jsx)(r.pj,{children:e.userEmail}),(0,a.jsx)(r.pj,{children:"N/A_PACKAGE"!==e.date?D(e.date,"PPP"):"Package"}),(0,a.jsx)(r.pj,{children:"N/A_PACKAGE"!==e.time?e.time:"N/A"}),(0,a.jsx)(r.pj,{children:(0,a.jsx)(o.C,{variant:"confirmed"===e.status?"default":"completed"===e.status?"secondary":"cancelled"===e.status?"destructive":"secondary",className:"awaiting-payment"===e.status?"bg-yellow-400/20 text-yellow-700 dark:text-yellow-500 border-yellow-400/30":"payment-pending-confirmation"===e.status?"bg-blue-400/20 text-blue-700 dark:text-blue-500 border-blue-400/30":"",children:I(e.status)})}),(0,a.jsx)(r.pj,{children:D(e.createdAt,"PPp")}),(0,a.jsx)(r.pj,{className:"text-right",children:(0,a.jsxs)(c.h_,{children:[(0,a.jsx)(c.$F,{asChild:!0,children:(0,a.jsxs)(d.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsx)(u.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(c.AW,{align:"end",children:[(0,a.jsx)(c.Ju,{children:"Actions"}),("awaiting-payment"===e.status||"payment-pending-confirmation"===e.status)&&(0,a.jsxs)(c.Xi,{onClick:()=>F(e,"confirmed"),children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4 text-primary"})," Confirm Payment"]}),(0,a.jsxs)(c.Xi,{onClick:()=>L({isOpen:!0,booking:e,link:e.zoomLink||"",isSaving:!1}),children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"})," ",e.zoomLink?"Edit":"Add"," Zoom Link"]}),(0,a.jsx)(c.VD,{}),(0,a.jsxs)(c.Xi,{onClick:()=>F(e,"completed"),disabled:"completed"===e.status,children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 text-blue-500"})," Mark as Completed"]}),(0,a.jsxs)(c.Xi,{onClick:()=>F(e,"cancelled"),disabled:"cancelled"===e.status,children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4 text-red-500"})," Mark as Cancelled"]}),(0,a.jsx)(c.VD,{}),(0,a.jsxs)(c.Xi,{className:"text-red-600 hover:!text-red-600 focus:!text-red-600",onClick:()=>V(e),children:[(0,a.jsx)(g.Z,{className:"mr-2 h-4 w-4"})," Delete Booking"]})]})]})})]},e.id))})]})}),(0,a.jsx)("div",{className:"md:hidden space-y-4",children:s.map(e=>(0,a.jsxs)(S.Zb,{className:"shadow-md",children:[(0,a.jsx)(S.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S.ll,{className:"text-lg",children:e.userName}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.userEmail})]}),(0,a.jsx)(o.C,{variant:"confirmed"===e.status?"default":"completed"===e.status?"secondary":"cancelled"===e.status?"destructive":"secondary",className:"awaiting-payment"===e.status?"bg-yellow-400/20 text-yellow-700 dark:text-yellow-500 border-yellow-400/30":"payment-pending-confirmation"===e.status?"bg-blue-400/20 text-blue-700 dark:text-blue-500 border-blue-400/30":"",children:I(e.status)})]})}),(0,a.jsxs)(S.aY,{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"N/A_PACKAGE"!==e.date?D(e.date,"PPP"):"Package"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"N/A_PACKAGE"!==e.time?e.time:"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Booked on ",D(e.createdAt,"PP")]})]})]}),(0,a.jsxs)(S.eW,{className:"flex flex-col gap-2",children:[("awaiting-payment"===e.status||"payment-pending-confirmation"===e.status)&&(0,a.jsxs)(d.z,{onClick:()=>F(e,"confirmed"),className:"w-full",size:"sm",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"})," Confirm Payment"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 w-full",children:[(0,a.jsxs)(d.z,{onClick:()=>F(e,"completed"),disabled:"completed"===e.status,variant:"outline",size:"sm",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"})," Completed"]}),(0,a.jsxs)(d.z,{onClick:()=>F(e,"cancelled"),disabled:"cancelled"===e.status,variant:"outline",size:"sm",children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"})," Cancelled"]})]}),(0,a.jsxs)(d.z,{onClick:()=>L({isOpen:!0,booking:e,link:e.zoomLink||"",isSaving:!1}),variant:"outline",size:"sm",className:"w-full",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"})," ",e.zoomLink?"Edit":"Add"," Zoom Link"]}),(0,a.jsxs)(d.z,{onClick:()=>V(e),variant:"destructive",size:"sm",className:"w-full mt-2",children:[(0,a.jsx)(g.Z,{className:"mr-2 h-4 w-4"})," Delete"]})]})]},e.id))}),(0,a.jsx)(P.Vq,{open:O.isOpen,onOpenChange:e=>!e&&L({isOpen:!1,booking:null,link:"",isSaving:!1}),children:(0,a.jsxs)(P.cZ,{children:[(0,a.jsxs)(P.fK,{children:[(0,a.jsx)(P.$N,{children:"Add/Edit Zoom Link"}),(0,a.jsxs)(P.Be,{children:["Provide the Zoom meeting link for the lesson with ",null===(e=O.booking)||void 0===e?void 0:e.userName," on ",(null===(t=O.booking)||void 0===t?void 0:t.date)?D(O.booking.date,"PPP"):"","."]})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(Z._,{htmlFor:"zoom-link",children:"Zoom Link"}),(0,a.jsx)(E.I,{id:"zoom-link",value:O.link,onChange:e=>L(t=>({...t,link:e.target.value})),placeholder:"https://zoom.us/j/..."})]}),(0,a.jsxs)(P.cN,{children:[(0,a.jsx)(d.z,{variant:"outline",onClick:()=>L({isOpen:!1,booking:null,link:"",isSaving:!1}),children:"Cancel"}),(0,a.jsxs)(d.z,{onClick:Y,disabled:O.isSaving,children:[O.isSaving&&(0,a.jsx)(C.$,{size:"sm",className:"mr-2"}),"Save Link"]})]})]})}),(0,a.jsx)(z.aR,{open:!!R,onOpenChange:e=>!e&&V(null),children:(0,a.jsxs)(z._T,{children:[(0,a.jsxs)(z.fY,{children:[(0,a.jsx)(z.f$,{children:"Are you absolutely sure?"}),(0,a.jsxs)(z.yT,{children:["This action cannot be undone. This will permanently delete the booking for ",null==R?void 0:R.userName," on ",(null==R?void 0:R.date)!=="N/A_PACKAGE"?D(null==R?void 0:R.date,"PPP"):"a package","."]})]}),(0,a.jsxs)(z.xo,{children:[(0,a.jsx)(z.le,{onClick:()=>V(null),children:"Cancel"}),(0,a.jsx)(z.OL,{onClick:()=>R&&T(R.id),className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete booking"})]})]})})]})}},29943:function(e,t,s){"use strict";s.d(t,{OL:function(){return g},_T:function(){return u},aR:function(){return o},f$:function(){return p},fY:function(){return f},le:function(){return j},vW:function(){return d},xo:function(){return x},yT:function(){return h}});var a=s(57437),n=s(2265),i=s(76669),l=s(49354),r=s(89733);let o=i.fC,d=i.xz,c=i.h_,m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n,ref:t})});m.displayName=i.aV.displayName;let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n})]})});u.displayName=i.VY.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};f.displayName="AlertDialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="AlertDialogFooter";let p=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold",s),...n})});p.displayName=i.Dx.displayName;let h=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...n})});h.displayName=i.dk.displayName;let g=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.aU,{ref:t,className:(0,l.cn)((0,r.d)(),s),...n})});g.displayName=i.aU.displayName;let j=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.$j,{ref:t,className:(0,l.cn)((0,r.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...n})});j.displayName=i.$j.displayName},54662:function(e,t,s){"use strict";s.d(t,{$N:function(){return h},Be:function(){return g},GG:function(){return m},Vq:function(){return o},cN:function(){return p},cZ:function(){return f},fK:function(){return x},hg:function(){return d}});var a=s(57437),n=s(2265),i=s(13304),l=s(74732),r=s(49354);let o=i.fC,d=i.xz,c=i.h_,m=i.x8,u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.aV,{ref:t,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n})});u.displayName=i.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(i.VY,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[n,(0,a.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=i.VY.displayName;let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};x.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let h=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.Dx,{ref:t,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",s),...n})});h.displayName=i.Dx.displayName;let g=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.dk,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});g.displayName=i.dk.displayName},77209:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var a=s(57437),n=s(2265),i=s(49354);let l=n.forwardRef((e,t)=>{let{className:s,type:n,...l}=e;return(0,a.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"},70402:function(e,t,s){"use strict";s.d(t,{_:function(){return d}});var a=s(57437),n=s(2265),i=s(38364),l=s(13027),r=s(49354);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(i.f,{ref:t,className:(0,r.cn)(o(),s),...n})});d.displayName=i.f.displayName},89736:function(e,t,s){"use strict";s.d(t,{_v:function(){return c},aJ:function(){return d},pn:function(){return r},u:function(){return o}});var a=s(57437),n=s(2265),i=s(27071),l=s(49354);let r=i.zt,o=i.fC,d=i.xz,c=n.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...r}=e;return(0,a.jsx)(i.VY,{ref:t,sideOffset:n,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})});c.displayName=i.VY.displayName}},function(e){e.O(0,[4358,139,6244,537,54,3959,381,5510,1294,3304,6680,2765,2938,9705,2971,7023,1744],function(){return e(e.s=83611)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{20957:function(e,s,r){Promise.resolve().then(r.bind(r,5207))},5207:function(e,s,r){"use strict";r.d(s,{StudentsManager:function(){return C}});var a=r(57437),n=r(2265),t=r(69842),i=r(89506),l=r(47304),d=r(80420),c=r(79055),o=r(89733),h=r(31590),u=r(14468),m=r(73344),x=r(39582),j=r(69893),f=r(22315),p=r(23785),N=r(80624),v=r(28420),w=r(86763),g=r(91892),y=r(48185);function C(){let[e,s]=(0,n.useState)([]),[r,C]=(0,n.useState)(!0),{toast:b}=(0,w.pm)(),A=async()=>{C(!0);try{var e;let r=await (null===(e=i.I.currentUser)||void 0===e?void 0:e.getIdToken());if(!r)throw Error("User not authenticated");let a=await fetch("/api/admin/students",{headers:{Authorization:"Bearer ".concat(r)}}),n=await a.json();if(!a.ok||!n.success)throw Error(n.error||"Failed to fetch students from server.");let t=n.data.map(e=>({...e,createdAt:(0,N.D)(e.createdAt)}));s(t)}catch(e){console.error("Error fetching students:",e),b({title:"Error",description:e.message||"Could not fetch student data.",variant:"destructive"})}finally{C(!1)}};(0,n.useEffect)(()=>{let e=i.I.onAuthStateChanged(e=>{e?A():C(!1)});return()=>e()},[]);let E=e=>{if(!e)return"U";let s=e.split(" ");return s.length>1&&s[0]&&s[s.length-1]?"".concat(s[0][0]).concat(s[s.length-1][0]).toUpperCase():e.substring(0,2).toUpperCase()},k=async(e,s)=>{try{let r=(0,t.JU)(i.db,"users",e);await (0,t.r7)(r,{role:s}),b({title:"Role Updated",description:"User role changed to ".concat(s,".")}),A()}catch(e){console.error("Error updating user role:",e),b({title:"Error",description:"Could not update user role.",variant:"destructive"})}};return r?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(g.$,{size:"lg"})}):0===e.length?(0,a.jsx)("p",{className:"text-muted-foreground",children:"No students found."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,a.jsxs)(l.iA,{children:[(0,a.jsx)(l.xD,{children:(0,a.jsxs)(l.SC,{children:[(0,a.jsx)(l.ss,{children:"Name"}),(0,a.jsx)(l.ss,{children:"Email"}),(0,a.jsx)(l.ss,{children:"Role"}),(0,a.jsx)(l.ss,{children:"Amharic Level"}),(0,a.jsx)(l.ss,{children:"Joined On"}),(0,a.jsx)(l.ss,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(l.RM,{children:e.map(e=>{var s;return(0,a.jsxs)(l.SC,{children:[(0,a.jsx)(l.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(d.qE,{className:"h-9 w-9",children:[(0,a.jsx)(d.F$,{src:e.photoURL||void 0,alt:e.name,"data-ai-hint":"user avatar"}),(0,a.jsx)(d.Q5,{children:E(e.name)})]}),(0,a.jsx)("span",{className:"font-medium",children:e.name})]})}),(0,a.jsx)(l.pj,{children:e.email}),(0,a.jsx)(l.pj,{children:(0,a.jsx)(c.C,{variant:"admin"===e.role?"destructive":"secondary",children:e.role.charAt(0).toUpperCase()+e.role.slice(1)})}),(0,a.jsx)(l.pj,{children:(0,a.jsx)(c.C,{variant:"outline",children:(null===(s=e.amharicLevel)||void 0===s?void 0:s.replace(/-/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "))||"N/A"})}),(0,a.jsx)(l.pj,{children:(0,v.WU)(e.createdAt,"PP")}),(0,a.jsx)(l.pj,{className:"text-right",children:(0,a.jsxs)(h.h_,{children:[(0,a.jsx)(h.$F,{asChild:!0,children:(0,a.jsxs)(o.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsx)(u.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(h.AW,{align:"end",children:[(0,a.jsx)(h.Ju,{children:"User Actions"}),(0,a.jsxs)(h.Xi,{disabled:!0,children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"})," Send Email (Soon)"]}),(0,a.jsxs)(h.Xi,{disabled:!0,children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"})," View Bookings (Soon)"]}),(0,a.jsxs)(h.Xi,{disabled:!0,children:[(0,a.jsx)(j.Z,{className:"mr-2 h-4 w-4"})," View Progress (Soon)"]}),(0,a.jsx)(h.VD,{}),(0,a.jsx)(h.Ju,{children:"Change Role"}),(0,a.jsxs)(h.Xi,{onClick:()=>k(e.uid,"admin"),disabled:"admin"===e.role,className:"admin"===e.role?"":"cursor-pointer",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4 text-destructive"})," Make Admin"]}),(0,a.jsxs)(h.Xi,{onClick:()=>k(e.uid,"student"),disabled:"student"===e.role,className:"student"===e.role?"":"cursor-pointer",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 text-primary"})," Make Student"]})]})]})})]},e.uid)})})]})}),(0,a.jsx)("div",{className:"md:hidden space-y-4",children:e.map(e=>{var s;return(0,a.jsxs)(y.Zb,{className:"shadow-md",children:[(0,a.jsx)(y.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(d.qE,{className:"h-10 w-10",children:[(0,a.jsx)(d.F$,{src:e.photoURL||void 0,alt:e.name,"data-ai-hint":"user avatar"}),(0,a.jsx)(d.Q5,{children:E(e.name)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.ll,{className:"text-lg",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email})]})]}),(0,a.jsxs)(h.h_,{children:[(0,a.jsx)(h.$F,{asChild:!0,children:(0,a.jsxs)(o.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsx)(u.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(h.AW,{align:"end",children:[(0,a.jsx)(h.Ju,{children:"User Actions"}),(0,a.jsxs)(h.Xi,{disabled:!0,children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"})," Send Email (Soon)"]}),(0,a.jsx)(h.VD,{}),(0,a.jsx)(h.Ju,{children:"Change Role"}),(0,a.jsxs)(h.Xi,{onClick:()=>k(e.uid,"admin"),disabled:"admin"===e.role,children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4 text-destructive"})," Make Admin"]}),(0,a.jsxs)(h.Xi,{onClick:()=>k(e.uid,"student"),disabled:"student"===e.role,children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 text-primary"})," Make Student"]})]})]})]})}),(0,a.jsxs)(y.aY,{className:"space-y-3 text-sm border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-muted-foreground",children:"Role:"}),(0,a.jsx)(c.C,{variant:"admin"===e.role?"destructive":"secondary",children:e.role})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-muted-foreground",children:"Level:"}),(0,a.jsx)(c.C,{variant:"outline",children:(null===(s=e.amharicLevel)||void 0===s?void 0:s.replace(/-/g," "))||"N/A"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-muted-foreground",children:"Joined:"}),(0,a.jsx)("span",{children:(0,v.WU)(e.createdAt,"PP")})]})]})]},e.uid)})})]})}},80420:function(e,s,r){"use strict";r.d(s,{F$:function(){return d},Q5:function(){return c},qE:function(){return l}});var a=r(57437),n=r(2265),t=r(81464),i=r(49354);let l=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,a.jsx)(t.fC,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...n})});l.displayName=t.fC.displayName;let d=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,a.jsx)(t.Ee,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",r),...n})});d.displayName=t.Ee.displayName;let c=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,a.jsx)(t.NY,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...n})});c.displayName=t.NY.displayName}},function(e){e.O(0,[4358,139,6244,537,54,3959,381,5510,1294,6680,5275,9705,2971,7023,1744],function(){return e(e.s=20957)}),_N_E=e.O()}]);
"use strict";(()=>{var e={};e.id=3230,e.ids=[3230],e.modules={92509:e=>{e.exports=require("firebase-admin")},65877:e=>{e.exports=require("firebase-admin/auth")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},15812:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>E,patchFetch:()=>I,requestAsyncStorage:()=>C,routeModule:()=>D,serverHooks:()=>A,staticGenerationAsyncStorage:()=>T});var r={};a.r(r),a.d(r,{POST:()=>M});var i=a(49303),n=a(88716),o=a(60670),s=a(87070),l=a(82421),d=a(65877),c=a(21067),u=a(95528),h=a(22313);function p(e,t){let a,r;let i=t?.additionalDigits??2,n=function(e){let t;let a={},r=e.split(m.dateTimeDelimiter);if(r.length>2)return a;if(/:/.test(r[0])?t=r[0]:(a.date=r[0],t=r[1],m.timeZoneDelimiter.test(a.date)&&(a.date=e.split(m.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length))),t){let e=m.timezone.exec(t);e?(a.time=t.replace(e[1],""),a.timezone=e[1]):a.time=t}return a}(e);if(n.date){let e=function(e,t){let a=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(a);if(!r)return{year:NaN,restDateString:""};let i=r[1]?parseInt(r[1]):null,n=r[2]?parseInt(r[2]):null;return{year:null===n?i:100*n,restDateString:e.slice((r[1]||r[2]).length)}}(n.date,i);a=function(e,t){if(null===t)return new Date(NaN);let a=e.match(y);if(!a)return new Date(NaN);let r=!!a[4],i=f(a[1]),n=f(a[2])-1,o=f(a[3]),s=f(a[4]),l=f(a[5])-1;if(r)return s>=1&&s<=53&&l>=0&&l<=6?function(e,t,a){let r=new Date(0);r.setUTCFullYear(e,0,4);let i=r.getUTCDay()||7;return r.setUTCDate(r.getUTCDate()+((t-1)*7+a+1-i)),r}(t,s,l):new Date(NaN);{let e=new Date(0);return n>=0&&n<=11&&o>=1&&o<=(w[n]||(b(t)?29:28))&&i>=1&&i<=(b(t)?366:365)?(e.setUTCFullYear(t,n,Math.max(i,o)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);let o=a.getTime(),s=0;if(n.time&&isNaN(s=function(e){let t=e.match(k);if(!t)return NaN;let a=v(t[1]),r=v(t[2]),i=v(t[3]);return(24===a?0===r&&0===i:i>=0&&i<60&&r>=0&&r<60&&a>=0&&a<25)?a*h.vh+r*h.yJ+1e3*i:NaN}(n.time)))return new Date(NaN);if(n.timezone){if(isNaN(r=function(e){if("Z"===e)return 0;let t=e.match(g);if(!t)return 0;let a="+"===t[1]?-1:1,r=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return i>=0&&i<=59?a*(r*h.vh+i*h.yJ):NaN}(n.timezone)))return new Date(NaN)}else{let e=new Date(o+s),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(o+s+r)}let m={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},y=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,k=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,g=/^([+-])(\d{2})(?::?(\d{2}))?$/;function f(e){return e?parseInt(e):1}function v(e){return e&&parseFloat(e.replace(",","."))||0}let w=[31,null,31,30,31,30,31,31,30,31,30,31];function b(e){return e%400==0||e%4==0&&e%100!=0}try{(0,l.xH)()}catch(e){console.error("CRITICAL: Failed to initialize Firebase Admin SDK in block/route.ts",e)}let x=(0,d.getAuth)(),N=c.Ry({tutorId:c.Z_().min(1),startISO:c.Z_().datetime(),endISO:c.Z_().datetime(),note:c.Z_().optional()}).refine(e=>new Date(e.endISO)>new Date(e.startISO),{message:"End time must be after start time",path:["endISO"]});async function M(e){try{let t=e.headers.get("Authorization")?.split("Bearer ")[1];if(!t)return s.NextResponse.json({success:!1,error:"No authentication token provided."},{status:401});let a=await x.verifyIdToken(t);if(!(a.email===u.Nj||!0===a.admin))return s.NextResponse.json({success:!1,error:"User does not have admin privileges."},{status:403});let r=await e.json(),i=N.safeParse(r);if(!i.success)return s.NextResponse.json({success:!1,error:"Invalid input",details:i.error.flatten().fieldErrors},{status:400});let{tutorId:n,startISO:o,endISO:d,note:c}=i.data,h=p(o),m=p(d),y=await l.iW.runTransaction(async e=>{let t=l.iW.collection("bookings").where("tutorId","==",n).where("status","in",["confirmed","awaiting-payment","payment-pending-confirmation"]).where("startTime","<",l.EK.fromDate(m)),r=(await e.get(t)).docs.find(e=>{let t=e.data();return!!t.endTime&&t.endTime.toDate()>h});if(r)throw console.warn("Conflict found:",{blockStart:h,blockEnd:m,bookingStart:r.data().startTime.toDate(),bookingEnd:r.data().endTime.toDate()}),Error("slot_already_booked");let i=l.iW.collection("timeOff").doc(),s={tutorId:n,startISO:o,endISO:d,note:c||"",blockedById:a.uid,blockedByEmail:a.email,createdAt:l.EK.now()};return e.set(i,s),{id:i.id,...s}});return s.NextResponse.json({success:!0,data:y},{status:201})}catch(e){if(console.error("API Error (/availability/block):",e),e.message.includes("slot_already_booked"))return s.NextResponse.json({success:!1,error:"This time slot is already booked by a student.",details:e.message},{status:409});return s.NextResponse.json({success:!1,error:"Failed to block time slot.",details:e?.message},{status:500})}}let D=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/availability/block/route",pathname:"/api/availability/block",filename:"route",bundlePath:"app/api/availability/block/route"},resolvedPagePath:"/home/user/studio/src/app/api/availability/block/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:C,staticGenerationAsyncStorage:T,serverHooks:A}=D,E="/api/availability/block/route";function I(){return(0,o.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:T})}},95528:(e,t,a)=>{a.d(t,{Nj:()=>l,Ru:()=>d,xK:()=>s});var r=a(31804),i=a(72538);(0,i.Z)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),(0,i.Z)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),(0,i.Z)("LibraryBig",[["rect",{width:"8",height:"18",x:"3",y:"3",rx:"1",key:"oynpb5"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M20.4 18.9c.2.5-.1 1.1-.6 1.3l-1.9.7c-.5.2-1.1-.1-1.3-.6L11.1 5.1c-.2-.5.1-1.1.6-1.3l1.9-.7c.5-.2 1.1.1 1.3.6Z",key:"1qboyk"}]]),(0,i.Z)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),(0,i.Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var n=a(17450);(0,i.Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),(0,i.Z)("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),(0,i.Z)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),(0,i.Z)("SquareChartGantt",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 8h7",key:"kbo1nt"}],["path",{d:"M8 12h6",key:"ikassy"}],["path",{d:"M11 16h5",key:"oq65wt"}]]),(0,i.Z)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var o=a(80027);r.Z,n.Z,r.Z,o.Z;let s={name:"Mahder Negash Mamo",bio:"Experienced Amharic teacher who makes language learning fun, simple, and interactive. Join me for easy lessons packed with culture and conversation!",shortIntro:"Professional Amharic Tutor for Learners Worldwide",teachingStyle:"My teaching style is patient, interactive, and tailored to each student's pace and goals. I use a mix of conversational practice, structured exercises, and cultural insights to make learning both effective and enjoyable.",services:["1-on-1 Personalized Lessons","Group Conversation Classes","Beginner to Advanced Levels","Accent & Pronunciation Coaching"],languages:["Amharic","English"],experience:"5+ years",imageUrl:"https://picsum.photos/400/400",dataAiHint:"tutor portrait",videoUrl:"https://www.youtube.com/embed/your_video_id_here"},l=process.env.NEXT_PUBLIC_ADMIN_EMAIL||"mahdernmamo@gmail.com",d="mahdernmamo@gmail.com"},82421:(e,t,a)=>{a.d(t,{CZ:()=>l,EK:()=>n,iW:()=>s,xH:()=>o});var r=a(92509),i=a.n(r);let n=i().firestore.Timestamp;function o(){if(i().apps.length>0)return i().app();let e={projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n")};if(!e.projectId||!e.clientEmail||!e.privateKey){let e="CRITICAL: Firebase Admin SDK credentials are not set correctly in environment variables. Check your .env file or hosting configuration.";throw console.error(e),Error(e)}try{let t=i().initializeApp({credential:i().credential.cert(e)});return console.log("Firebase Admin SDK initialized successfully."),t}catch(e){if(console.error("CRITICAL: Firebase admin initialization error:",e.message),"app/invalid-credential"===e.code)throw Error("Could not initialize Firebase Admin SDK. The provided credentials are invalid or malformed.");throw Error("Could not initialize Firebase Admin SDK. Please check server logs for details.")}}o();let s=i().firestore(),l=i().auth()},22313:(e,t,a)=>{a.d(t,{jE:()=>r,qk:()=>o,vh:()=>n,yJ:()=>i});let r=6048e5,i=6e4,n=36e5,o=1e3},72538:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(71159);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:s="",children:l,iconNode:d,...c},u)=>(0,r.createElement)("svg",{ref:u,...o,width:t,height:t,stroke:e,strokeWidth:i?24*Number(a)/Number(t):a,className:n("lucide",s),...c},[...d.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(l)?l:[l]])),l=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...o},l)=>(0,r.createElement)(s,{ref:l,iconNode:t,className:n(`lucide-${i(e)}`,a),...o}));return a.displayName=`${e}`,a}},17450:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(72538).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},80027:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(72538).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},31804:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(72538).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5972,1067],()=>a(15812));module.exports=r})();
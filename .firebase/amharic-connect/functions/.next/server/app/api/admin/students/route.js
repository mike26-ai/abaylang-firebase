"use strict";(()=>{var e={};e.id=5078,e.ids=[5078],e.modules={92509:e=>{e.exports=require("firebase-admin")},65877:e=>{e.exports=require("firebase-admin/auth")},12594:e=>{e.exports=require("firebase-admin/firestore")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},41735:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>E,patchFetch:()=>x,requestAsyncStorage:()=>v,routeModule:()=>f,serverHooks:()=>A,staticGenerationAsyncStorage:()=>g});var i={};t.r(i),t.d(i,{GET:()=>h,dynamic:()=>m});var a=t(49303),n=t(88716),o=t(60670),s=t(87070),d=t(82421),u=t(65877),l=t(12594);(0,d.xH)();let c=(0,u.getAuth)(),p=(0,l.getFirestore)(),m="force-dynamic";async function h(e){try{let r=e.headers.get("Authorization")?.split("Bearer ")[1];if(!r)return s.NextResponse.json({error:"Unauthorized: No authentication token provided."},{status:401});let t=await c.verifyIdToken(r),i=(await p.collection("users").doc(t.uid).get()).data();if(i?.role!=="admin")return s.NextResponse.json({error:"Forbidden: User does not have admin privileges."},{status:403});let a=(await p.collection("users").orderBy("createdAt","desc").get()).docs.map(e=>{let r=e.data();return{...r,uid:e.id,createdAt:r.createdAt?.toDate().toISOString()}});return s.NextResponse.json({success:!0,data:a})}catch(e){if(console.error("API Error (/api/admin/students):",e),e.code?.startsWith("auth/"))return s.NextResponse.json({error:"Authentication error. Please log in again."},{status:401});return s.NextResponse.json({error:"Failed to fetch student data.",details:e.message},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/students/route",pathname:"/api/admin/students",filename:"route",bundlePath:"app/api/admin/students/route"},resolvedPagePath:"/home/user/studio/src/app/api/admin/students/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:v,staticGenerationAsyncStorage:g,serverHooks:A}=f,E="/api/admin/students/route";function x(){return(0,o.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:g})}},82421:(e,r,t)=>{t.d(r,{CZ:()=>d,EK:()=>n,iW:()=>s,xH:()=>o});var i=t(92509),a=t.n(i);let n=a().firestore.Timestamp;function o(){if(a().apps.length>0)return a().app();let e={projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n")};if(!e.projectId||!e.clientEmail||!e.privateKey){let e="CRITICAL: Firebase Admin SDK credentials are not set correctly in environment variables. Check your .env file or hosting configuration.";throw console.error(e),Error(e)}try{let r=a().initializeApp({credential:a().credential.cert(e)});return console.log("Firebase Admin SDK initialized successfully."),r}catch(e){if(console.error("CRITICAL: Firebase admin initialization error:",e.message),"app/invalid-credential"===e.code)throw Error("Could not initialize Firebase Admin SDK. The provided credentials are invalid or malformed.");throw Error("Could not initialize Firebase Admin SDK. Please check server logs for details.")}}o();let s=a().firestore(),d=a().auth()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[8948,5972],()=>t(41735));module.exports=i})();